<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ "/assets/css/style.css" | relative_url }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <title>{{ page.title }} | {{ site.title }}</title>
</head>
<body>
    <header class="site-header">
        <div class="header-container">
            <h1 class="site-title">
                <a href="{{ "/" | relative_url }}">
                    <img src="{{ '/assets/images/icons/logo_bdi_v3.svg' | relative_url }}" alt="{{ site.title }}" class="site-logo">
                    <span class="site-title-text">{{ site.title }}</span>
                </a>
            </h1>
            <button class="menu-toggle" aria-label="Toggle menu">
                <img src="{{ '/assets/images/icons/menu_icon.svg' | relative_url }}" alt="Menu" class="menu-icon">
            </button>
        </div>
    </header>

    <!-- Tabs Navigation -->
    <nav class="tabs-navigation">
        <div class="tabs-container">
            <button class="tab-button active" data-tab="about">About</button>
            <button class="tab-button" data-tab="professor">Professor</button>
            <button class="tab-button" data-tab="members">Members</button>
            <button class="tab-button" data-tab="publications">Publications</button>
            <button class="tab-button" data-tab="projects">Projects</button>
            <button class="tab-button" data-tab="photos">Photos</button>
            <button class="tab-button" data-tab="contacts">Contacts</button>
        </div>
    </nav>

    <!-- Side Menu Overlay -->
    <div class="side-menu-overlay"></div>
    
    <!-- Side Menu -->
    <nav class="side-menu">
        <div class="side-menu-header">
            <button class="menu-close" aria-label="Close menu">
                <span>&times;</span>
            </button>
        </div>
        <ul class="side-menu-list">
            <li><button class="side-menu-tab" data-tab="about">About</button></li>
            <li><button class="side-menu-tab" data-tab="professor">Professor</button></li>
            <li><button class="side-menu-tab" data-tab="members">Members</button></li>
            <li><button class="side-menu-tab" data-tab="publications">Publications</button></li>
            <li><button class="side-menu-tab" data-tab="projects">Projects</button></li>
            <li><button class="side-menu-tab" data-tab="photos">Photos</button></li>
            <li><button class="side-menu-tab" data-tab="contacts">Contacts</button></li>
        </ul>
    </nav>

    <main>
        {{ content }}
    </main>

    <footer class="site-footer">
        <div class="footer-container">
            <p>&copy; {{ site.time | date: "%Y" }} {{ site.title }}. All rights reserved.</p>
            {% if site.github_username %}
            <p>
                <a href="https://github.com/{{ site.github_username }}" target="_blank" rel="noopener">GitHub</a>
            </p>
            {% endif %}
        </div>
    </footer>

    <script>
        // Menu toggle functionality
        const menuToggle = document.querySelector('.menu-toggle');
        const menuClose = document.querySelector('.menu-close');
        const sideMenu = document.querySelector('.side-menu');
        const sideMenuOverlay = document.querySelector('.side-menu-overlay');

        function openSideMenu() {
            sideMenu.classList.add('active');
            sideMenuOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeSideMenu() {
            sideMenu.classList.remove('active');
            sideMenuOverlay.classList.remove('active');
            document.body.style.overflow = '';
        }

        if (menuToggle) {
            menuToggle.addEventListener('click', openSideMenu);
        }

        if (menuClose) {
            menuClose.addEventListener('click', closeSideMenu);
        }

        if (sideMenuOverlay) {
            sideMenuOverlay.addEventListener('click', closeSideMenu);
        }

        // Tab switching functionality
        function switchTab(tabId) {
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Remove active class from all side menu tabs
            document.querySelectorAll('.side-menu-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Hide all tab panels
            document.querySelectorAll('.tab-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Show selected tab panel
            const targetPanel = document.querySelector(`#${tabId}.tab-panel`);
            if (targetPanel) {
                targetPanel.classList.add('active');
            }
            
            // Activate corresponding tab button
            const targetTabButton = document.querySelector(`.tab-button[data-tab="${tabId}"]`);
            if (targetTabButton) {
                targetTabButton.classList.add('active');
            }
            
            // Activate corresponding side menu tab
            const targetSideMenuTab = document.querySelector(`.side-menu-tab[data-tab="${tabId}"]`);
            if (targetSideMenuTab) {
                targetSideMenuTab.classList.add('active');
            }
            
            // Update URL hash
            if (history.pushState) {
                history.pushState(null, null, `#${tabId}`);
            } else {
                window.location.hash = `#${tabId}`;
            }
            
            // Scroll to top of main content
            window.scrollTo(0, 0);
        }

        // Tab button click handlers
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                switchTab(tabId);
            });
        });

        // Side menu tab click handlers
        document.querySelectorAll('.side-menu-tab').forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                switchTab(tabId);
                closeSideMenu();
            });
        });

        // Handle initial hash on page load
        function handleInitialHash() {
            const hash = window.location.hash.substring(1);
            if (hash) {
                const targetPanel = document.querySelector(`#${hash}.tab-panel`);
                if (targetPanel) {
                    switchTab(hash);
                    return;
                }
            }
            // Default to first tab if no valid hash
            switchTab('about');
        }

        // Initialize on page load
        handleInitialHash();

        // Handle browser back/forward buttons
        window.addEventListener('popstate', function() {
            handleInitialHash();
        });
    </script>
</body>
</html>
